@page "/"
@rendermode InteractiveServer
@using MiniEshopBlazor.Models
@inject MiniEshopBlazor.Services.ProductService ProductService
@inject NavigationManager Navigation

<h2 class="page-title">Καλώς ήρθατε στο κατάστημά μας</h2>
<p class="text-muted2">Μερικά από τα προϊόντα μας</p>

@if (products == null)
{
    <p class="text-muted2">Φόρτωση...</p>
}
else if (!products.Any())
{
    <p class="text-muted2">Δεν υπάρχουν προϊόντα.</p>
}
else
{
    <div class="home-grid">
        @foreach (var product in FeaturedProducts)
        {
            <div class="home-card" @onclick="() => GoToDetails(product.Id)">
                <div class="home-img-wrap">
                    <img src="@(string.IsNullOrWhiteSpace(product.ImageUrl)
                                                         ? "/images/products/placeholder.jpg"
                                                         : product.ImageUrl)"
                         alt="@product.Name" />
                </div>

                <div class="home-title">
                    @product.Name
                </div>
            </div>
        }
    </div>

    <div class="home-more">
        <button class="btn btn-primary" @onclick="GoToProducts">
            Περισσότερα προϊόντα
        </button>
    </div>
}

@code {
    private List<Product> products;

    protected override async Task OnInitializedAsync()
    {
        products = await ProductService.GetAsync();
    }

    private IEnumerable<Product> FeaturedProducts =>
        products.Take(4);

    private void GoToProducts() =>
        Navigation.NavigateTo("/products");

    private void GoToDetails(string id) =>
        Navigation.NavigateTo($"/product/{id}");
}
